<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buku Nilai Digital (Versi Tanpa Firebase)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }
  </style>
</head>
<body class="p-4 sm:p-8 min-h-screen">
  <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6">
    <header class="text-center mb-6">
      <h1 class="text-3xl font-extrabold text-gray-800">üìò Buku Nilai Digital</h1>
      <p class="text-gray-500 text-sm">Versi tanpa Firebase ‚Äî data langsung tersimpan ke Google Sheets</p>
    </header>

    <form id="nilai-form" class="grid gap-4 md:grid-cols-2 mb-6">
      <div>
        <label class="block text-sm font-medium text-gray-700">Nama Siswa</label>
        <input id="nama" type="text" class="mt-1 w-full border rounded-lg p-2" required />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Kelas</label>
        <input id="kelas" type="text" class="mt-1 w-full border rounded-lg p-2" placeholder="7A / 8B" required />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Mapel</label>
        <input id="mapel" type="text" class="mt-1 w-full border rounded-lg p-2" placeholder="Matematika / Informatika" required />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Asesmen</label>
        <input id="asesmen" type="text" class="mt-1 w-full border rounded-lg p-2" placeholder="UH1 / PTS / PAS" required />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Nilai</label>
        <input id="nilai" type="number" min="0" max="100" class="mt-1 w-full border rounded-lg p-2" required />
      </div>
      <div class="flex items-end">
        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">Simpan</button>
      </div>
    </form>

    <div id="message" class="hidden p-3 rounded-lg text-sm text-center mb-4"></div>

    <h2 class="text-xl font-semibold mb-2">üìã Daftar Nilai</h2>
    <div class="overflow-x-auto">
      <table class="w-full border text-sm text-left" id="tabel-nilai">
        <thead class="bg-gray-100">
          <tr>
            <th class="border px-3 py-2">Nama</th>
            <th class="border px-3 py-2">Kelas</th>
            <th class="border px-3 py-2">Mapel</th>
            <th class="border px-3 py-2">Asesmen</th>
            <th class="border px-3 py-2">Nilai</th>
            <th class="border px-3 py-2">Tanggal</th>
          </tr>
        </thead>
        <tbody id="data-nilai"></tbody>
      </table>
    </div>
  </div>

  <script>
    const form = document.getElementById('nilai-form');
    const tabelNilai = document.getElementById('data-nilai');
    const msgBox = document.getElementById('message');

    // üîó Ganti dengan URL Web App Google Apps Script Anda
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbyK8MEei-bK1KLYmNxPjgG5u3JdLrElwwoW5_BuiKl8BhaVKrRDh6DSV3WfP5IzWyvv/exec';

    function showMessage(teks, warna = 'blue') {
      msgBox.textContent = teks;
      msgBox.className = `block p-3 rounded-lg text-white text-sm text-center mb-4 bg-${warna}-500`;
      setTimeout(() => (msgBox.classList.add('hidden')), 4000);
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        nama: document.getElementById('nama').value.trim(),
        kelas: document.getElementById('kelas').value.trim(),
        mapel: document.getElementById('mapel').value.trim(),
        asesmen: document.getElementById('asesmen').value.trim(),
        nilai: document.getElementById('nilai').value.trim(),
        waktu: new Date().toLocaleString('id-ID')
      };

      try {
        const res = await fetch(webAppUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (res.ok) {
          showMessage('‚úÖ Nilai berhasil disimpan & dikirim ke Google Sheets!', 'green');
          tambahKeTabel(data);
          form.reset();
        } else {
          throw new Error('Gagal mengirim data');
        }
      } catch (err) {
        console.error(err);
        showMessage('‚ùå Terjadi kesalahan saat mengirim data!', 'red');
      }
    });

    function tambahKeTabel(data) {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td class='border px-3 py-2'>${data.nama}</td>
        <td class='border px-3 py-2'>${data.kelas}</td>
        <td class='border px-3 py-2'>${data.mapel}</td>
        <td class='border px-3 py-2'>${data.asesmen}</td>
        <td class='border px-3 py-2 text-center'>${data.nilai}</td>
        <td class='border px-3 py-2'>${data.waktu}</td>
      `;
      tabelNilai.prepend(row);
    }
  </script>
</body>
</html>
